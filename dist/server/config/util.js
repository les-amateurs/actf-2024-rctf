"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.removeUndefined = exports.nullsafeParseBoolEnv = exports.nullsafeParseInt = exports.makeNullsafe = exports.parseBoolEnv = void 0;
exports.parseBoolEnv = (val) => {
    return ['true', 'yes', 'y', '1'].includes(val.toLowerCase().trim());
};
exports.makeNullsafe = (f) => {
    return x => (x === undefined) ? undefined : f(x);
};
exports.nullsafeParseInt = exports.makeNullsafe(parseInt);
exports.nullsafeParseBoolEnv = exports.makeNullsafe(exports.parseBoolEnv);
const _removeUndefined = (o) => {
    let hasKeys = false;
    for (const key of Object.keys(o)) {
        let v = o[key];
        if (typeof v === 'object' && v != null) {
            o[key] = v = _removeUndefined(v);
        }
        if (v === undefined || v === null) {
            delete o[key];
        }
        else {
            hasKeys = true;
        }
    }
    return hasKeys ? o : undefined;
};
exports.removeUndefined = (o) => {
    const cleaned = _removeUndefined(o);
    return cleaned !== null && cleaned !== void 0 ? cleaned : {};
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NlcnZlci9jb25maWcvdXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBYSxRQUFBLFlBQVksR0FBRyxDQUFDLEdBQVcsRUFBVyxFQUFFO0lBQ25ELE9BQU8sQ0FBQyxNQUFNLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxHQUFHLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLFdBQVcsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUE7QUFDckUsQ0FBQyxDQUFBO0FBRVksUUFBQSxZQUFZLEdBQUcsQ0FBVyxDQUFrQixFQUEyQyxFQUFFO0lBQ3BHLE9BQU8sQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDbEQsQ0FBQyxDQUFBO0FBRVksUUFBQSxnQkFBZ0IsR0FBRyxvQkFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFBO0FBQ3pDLFFBQUEsb0JBQW9CLEdBQUcsb0JBQVksQ0FBQyxvQkFBWSxDQUFDLENBQUE7QUFFOUQsTUFBTSxnQkFBZ0IsR0FBRyxDQUFJLENBQW9CLEVBQWlDLEVBQUU7SUFDbEYsSUFBSSxPQUFPLEdBQUcsS0FBSyxDQUFBO0lBQ25CLEtBQUssTUFBTSxHQUFHLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRTtRQUNoQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUE7UUFDZCxJQUFJLE9BQU8sQ0FBQyxLQUFLLFFBQVEsSUFBSSxDQUFDLElBQUksSUFBSSxFQUFFO1lBQ3RDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsZ0JBQWdCLENBQUMsQ0FBNEIsQ0FBTSxDQUFBO1NBQ2pFO1FBQ0QsSUFBSSxDQUFDLEtBQUssU0FBUyxJQUFJLENBQUMsS0FBSyxJQUFJLEVBQUU7WUFDakMsT0FBTyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUE7U0FDZDthQUFNO1lBQ0wsT0FBTyxHQUFHLElBQUksQ0FBQTtTQUNmO0tBQ0Y7SUFDRCxPQUFPLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUE7QUFDaEMsQ0FBQyxDQUFBO0FBRVksUUFBQSxlQUFlLEdBQUcsQ0FBb0MsQ0FBOEIsRUFBSyxFQUFFO0lBQ3RHLE1BQU0sT0FBTyxHQUFHLGdCQUFnQixDQUFDLENBQUMsQ0FBa0IsQ0FBQTtJQUNwRCxPQUFPLE9BQU8sYUFBUCxPQUFPLGNBQVAsT0FBTyxHQUFLLEVBQVEsQ0FBQTtBQUM3QixDQUFDLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgcGFyc2VCb29sRW52ID0gKHZhbDogc3RyaW5nKTogYm9vbGVhbiA9PiB7XG4gIHJldHVybiBbJ3RydWUnLCAneWVzJywgJ3knLCAnMSddLmluY2x1ZGVzKHZhbC50b0xvd2VyQ2FzZSgpLnRyaW0oKSlcbn1cblxuZXhwb3J0IGNvbnN0IG1ha2VOdWxsc2FmZSA9IDxBcmcsIFJldD4oZjogKHg6IEFyZykgPT4gUmV0KTogKHg6IEFyZyB8IHVuZGVmaW5lZCkgPT4gUmV0IHwgdW5kZWZpbmVkID0+IHtcbiAgcmV0dXJuIHggPT4gKHggPT09IHVuZGVmaW5lZCkgPyB1bmRlZmluZWQgOiBmKHgpXG59XG5cbmV4cG9ydCBjb25zdCBudWxsc2FmZVBhcnNlSW50ID0gbWFrZU51bGxzYWZlKHBhcnNlSW50KVxuZXhwb3J0IGNvbnN0IG51bGxzYWZlUGFyc2VCb29sRW52ID0gbWFrZU51bGxzYWZlKHBhcnNlQm9vbEVudilcblxuY29uc3QgX3JlbW92ZVVuZGVmaW5lZCA9IDxUPihvOiBSZWNvcmQ8c3RyaW5nLCBUPik6IFJlY29yZDxzdHJpbmcsIFQ+IHwgdW5kZWZpbmVkID0+IHtcbiAgbGV0IGhhc0tleXMgPSBmYWxzZVxuICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhvKSkge1xuICAgIGxldCB2ID0gb1trZXldXG4gICAgaWYgKHR5cGVvZiB2ID09PSAnb2JqZWN0JyAmJiB2ICE9IG51bGwpIHtcbiAgICAgIG9ba2V5XSA9IHYgPSBfcmVtb3ZlVW5kZWZpbmVkKHYgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pIGFzIFRcbiAgICB9XG4gICAgaWYgKHYgPT09IHVuZGVmaW5lZCB8fCB2ID09PSBudWxsKSB7XG4gICAgICBkZWxldGUgb1trZXldXG4gICAgfSBlbHNlIHtcbiAgICAgIGhhc0tleXMgPSB0cnVlXG4gICAgfVxuICB9XG4gIHJldHVybiBoYXNLZXlzID8gbyA6IHVuZGVmaW5lZFxufVxuXG5leHBvcnQgY29uc3QgcmVtb3ZlVW5kZWZpbmVkID0gPFQgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPj4obzogVCAmIFJlY29yZDxzdHJpbmcsIHVua25vd24+KTogVCA9PiB7XG4gIGNvbnN0IGNsZWFuZWQgPSBfcmVtb3ZlVW5kZWZpbmVkKG8pIGFzIFQgfCB1bmRlZmluZWRcbiAgcmV0dXJuIGNsZWFuZWQgPz8gKHt9IGFzIFQpXG59XG4iXX0=